(function(e){function n(n){for(var i,s,a=n[0],c=n[1],u=n[2],d=0,f=[];d<a.length;d++)s=a[d],o[s]&&f.push(o[s][0]),o[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);l&&l(n);while(f.length)f.shift()();return r.push.apply(r,u||[]),t()}function t(){for(var e,n=0;n<r.length;n++){for(var t=r[n],i=!0,a=1;a<t.length;a++){var c=t[a];0!==o[c]&&(i=!1)}i&&(r.splice(n--,1),e=s(s.s=t[0]))}return e}var i={},o={app:0},r=[];function s(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=i,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)s.d(t,i,function(n){return e[n]}.bind(null,i));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=n,a=a.slice();for(var u=0;u<a.length;u++)n(a[u]);var l=c;r.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("cd49")},2575:function(e,n,t){},"2e1d":function(e,n,t){"use strict";var i=t("2575"),o=t.n(i);o.a},6964:function(e,n,t){"use strict";var i=t("ff0f"),o=t.n(i);o.a},cd49:function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d");var i=t("2b0e"),o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("Home")],1)},r=[],s=t("d225"),a=t("308d"),c=t("6bb5"),u=t("4e2b"),l=t("9ab4"),d=t("60a3"),f=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[e.isadmin?e._e():[t("IsOpenMessage")],e.isadmin?[t("AdminForm")]:e._e()],2)},h=[],g=(t("34ef"),t("a481"),t("14b9"),t("7f7f"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("div",{staticClass:"container mt-2"},[t("h1",{staticClass:"text-center text-white"},[e.initDone?t("div",[e._v("Der Kiosk im Schwimmbad Ebrach ist gerade "+e._s(e.statusText)+"!")]):e._e(),e.hasError?t("div",[e._v("Der Service ist im Moment nicht verfübar!")]):e._e()]),e._m(0),t("h5",{staticClass:"text-center text-white mt-2"},[e._v("QR-Code zum Teilen der App")])])])}),p=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container mt-5 text-center"},[t("img",{staticClass:"img-fluid",attrs:{src:"/img/qr-code.png",alt:"QR Code"}})])}],v={name:"IsOpenMessage",data:function(){return{isopen:!1,initDone:!1,hasError:!1}},created:function(){var e=this;this.axios.get("/api/isopen").then(function(n){e.isopen=n.data.isopen,e.initDone=!0,e.updateBodyColor()}).catch(function(n){e.hasError=!0})},updated:function(){this.updateBodyColor()},computed:{statusText:function(){return this.isopen?"geöffnet":"geschlossen"},bodyColor:function(){return this.isopen?"#28a745":"#dc3545"}},methods:{updateBodyColor:function(){document.body.style.backgroundColor=this.bodyColor}}},b=v,m=t("2877"),w=Object(m["a"])(b,g,p,!1,null,null,null),k=w.exports,y=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"vld-parent"},[t("loading",{attrs:{active:e.isLoading,canCancel:e.canCancel,"is-full-page":e.fullPage,height:e.height,width:e.width,color:e.color,loader:e.loader,"background-color":e.bgColor},on:{"update:active":function(n){e.isLoading=n}}}),t("div",[t("div",{staticClass:"container mt-2"},[t("h1",{staticClass:"text-center text-white"},[e.initDone?t("div",[e._v("Der Kiosk im Schwimmbad Ebrach ist gerade "+e._s(e.statusText)+"!")]):e._e(),e.hasError?t("div",[e._v("Der Service ist im Moment nicht verfübar!")]):e._e()]),t("div",{staticClass:"container mt-5"},[t("button",{staticClass:"btn btn-block btn-lg",class:{" btn-danger":e.isopen," btn-success":!e.isopen},on:{click:e.toggle}},[t("h1",[e._v("Klicken um auf "+e._s(e.changingText)+" zu wechseln")])])])])])],1)},C=[],_=t("9062"),x=t.n(_),S=(t("e40d"),{name:"AdminForm",components:{Loading:x.a},data:function(){return{isopen:!1,initDone:!1,hasError:!1,isLoading:!1,fullPage:!0,canCancel:!1,useSlot:!1,loader:"spinner",color:"#ff7f00",bgColor:"#ffffff",height:128,width:128}},created:function(){var e=this;this.isLoading=!0,this.axios.get("/api/isopen").then(function(n){e.isopen=n.data.isopen,e.initDone=!0,e.updateBodyColor(),e.isLoading=!1}).catch(function(n){e.hasError=!0,e.isLoading=!1})},updated:function(){this.updateBodyColor()},computed:{statusText:function(){return this.isopen?"geöffnet":"geschlossen"},changingText:function(){return this.isopen?"geschlossen":"geöffnet"},bodyColor:function(){return this.isopen?"#28a745":"#dc3545"}},methods:{updateBodyColor:function(){document.body.style.backgroundColor=this.bodyColor},toggle:function(){var e=this;this.$bvModal.msgBoxConfirm("Wirklich auf '"+this.changingText+"' wechseln und Nachrichten an alle schicken?",{okTitle:"Ja, auf '"+this.changingText+"' wechseln und Nachrichten an alle schicken!",cancelTitle:"Nein, abbrechen!",buttonSize:"lg"}).then(function(n){!0===n&&(e.isLoading=!0,e.axios.put("api/toggle").then(function(){e.isopen=!e.isopen,e.isLoading=!1}))}).catch(function(e){})}}}),E=S,O=(t("2e1d"),Object(m["a"])(E,y,C,!1,null,null,null)),j=O.exports,M=t("bc3a"),R=t.n(M),T={name:"home",components:{IsOpenMessage:k,AdminForm:j},data:function(){return{notificationsSupported:!1,notificationsEnabled:!1,serviceWorkerRegistration:null,subscription:null,message:null,isadmin:!1}},methods:{enableNotifications:function(){var e=this;this.notificationsSupported&&!this.notificationsEnabled&&Notification.requestPermission().then(function(n){"granted"===n?e.createSubscription().then(function(n){return console.log("Home.vue: subscription created on the client",n),e.subscription=n,R.a.post("api/user",{username:localStorage.getItem("username")})}).then(function(n){var t=n.data,i=t.user;return console.log("Home.vue: user created on the server",i),localStorage.setItem("username",i.name),R.a.post("api/subscription",{subscription:e.subscription,userId:i.id})}).then(function(){e.showFirstNotification(),e.notificationsEnabled=!0}):console.log("Home.vue: User did not grant permission")})},createSubscription:function(){var e=this;return null===this.serviceWorkerRegistration?navigator.serviceWorker.ready.then(function(n){return e.serviceWorkerRegistration=n,e.subscribe(e.serviceWorkerRegistration)}):this.subscribe(this.serviceWorkerRegistration)},subscribe:function(e){console.log("Home.vue: create new subscription for this browser on this device");var n="BE4ll+PKxJkg5t8mmH6++lh3P6oD0M3wn8mNoJ5Dd0sMeGhIRpfUF37oCJ2rJXPfh91DnzolgL4SKzMOiIpC8A8=",t=this.urlBase64ToUint8Array(n);return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})},showFirstNotification:function(){this.serviceWorkerRegistration.showNotification("Benachrichtungen aktiviert!",{body:"Sie werden jetzt benachrichtigt, wenn der Kiosk im Schwimmbad Ebrach öffnet:)",icon:"/img/icons/android-chrome-192x192.png",badge:"/img/icons/kiosk-badge-96x96.png"})},findSubscription:function(){var e=this;return console.log("Home.vue: get active service worker registration"),navigator.serviceWorker.ready.then(function(n){return console.log("Home.vue: active service worker registration received"),e.serviceWorkerRegistration=n,e.getSubscription(e.serviceWorkerRegistration)})},getSubscription:function(e){return console.log("Home.vue: ask for available subscription"),e.pushManager.getSubscription()},urlBase64ToUint8Array:function(e){for(var n="=".repeat((4-e.length%4)%4),t=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(t),o=new Uint8Array(i.length),r=0;r<i.length;++r)o[r]=i.charCodeAt(r);return o}},created:function(){"Notification"in window&&"serviceWorker"in navigator&&(this.notificationsSupported=!0),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){"[REFRESH]"==e.data&&(console.log("Client Received Message: "+e.data),window.location.reload()),e.ports[0].postMessage("[REFRESHED]")})},mounted:function(){var e=this;this.findSubscription().then(function(n){null===n?(console.log("Home.vue: no active subscription found on the client"),e.enableNotifications()):(console.log("Active subscription found",n),e.notificationsEnabled=!0,e.subscription=n,R.a.post("api/user",{username:localStorage.getItem("username")}).then(function(n){var t=n.data,i=t.user;console.log("Home.vue: active user",i),e.isadmin=i.isadmin}))})}},D=T,H=Object(m["a"])(D,f,h,!1,null,null,null),N=H.exports,W=function(e){function n(){return Object(s["a"])(this,n),Object(a["a"])(this,Object(c["a"])(n).apply(this,arguments))}return Object(u["a"])(n,e),n}(d["b"]);W=l["a"]([Object(d["a"])({components:{Home:N}})],W);var A=W,B=A,P=(t("a151"),t("372f"),t("6964"),Object(m["a"])(B,o,r,!1,null,null,null)),L=P.exports,F=t("9483");Object(F["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var I=t("a7fe"),J=t.n(I),K=t("5f5b");i["default"].use(J.a,R.a),i["default"].use(K["a"]),i["default"].config.productionTip=!1,new i["default"]({render:function(e){return e(L)}}).$mount("#app")},ff0f:function(e,n,t){}});
//# sourceMappingURL=app.607d2272.js.map