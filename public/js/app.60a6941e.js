(function(e){function n(n){for(var i,s,a=n[0],c=n[1],u=n[2],f=0,d=[];f<a.length;f++)s=a[f],r[s]&&d.push(r[s][0]),r[s]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);l&&l(n);while(d.length)d.shift()();return o.push.apply(o,u||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],i=!0,a=1;a<t.length;a++){var c=t[a];0!==r[c]&&(i=!1)}i&&(o.splice(n--,1),e=s(s.s=t[0]))}return e}var i={},r={app:0},o=[];function s(n){if(i[n])return i[n].exports;var t=i[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=e,s.c=i,s.d=function(e,n,t){s.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,n){if(1&n&&(e=s(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)s.d(t,i,function(n){return e[n]}.bind(null,i));return t},s.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(n,"a",n),n},s.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=n,a=a.slice();for(var u=0;u<a.length;u++)n(a[u]);var l=c;o.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("cd49")},"07bb":function(e,n,t){},"6b51":function(e,n,t){},b0a0:function(e,n,t){"use strict";var i=t("07bb"),r=t.n(i);r.a},cd49:function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d");var i=t("2b0e"),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("Home")],1)},o=[],s=t("d225"),a=t("308d"),c=t("6bb5"),u=t("4e2b"),l=t("9ab4"),f=t("60a3"),d=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("IsOpenMessage")],1)},p=[],b=(t("34ef"),t("a481"),t("14b9"),t("7f7f"),function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("div",{staticClass:"jumbotron jumbotron-fluid text-white mb-0",class:{"bg-success":e.isopen,"bg-danger":!e.isopen}},[t("div",{staticClass:"container"},[t("h1",{staticClass:"text-center"},[e.initDone?t("div",[e._v("Der Kiosk im Schwimmbad Ebrach ist gerade "+e._s(e.statusText)+"!")]):e._e(),e.hasError?t("div",[e._v("Der Service ist im Moment nicht verfübar!")]):e._e()]),e._m(0),t("h4",{staticClass:"text-center"},[e._v("QR-Code zum Teilen der App")])])])])}),g=[function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"container mt-5 text-center"},[t("img",{staticClass:"img-fluid",attrs:{src:"/img/qr-code.png",alt:"QR Code"}})])}],v={name:"IsOpenMessage",data:function(){return{isopen:!1,initDone:!1,hasError:!1}},created:function(){var e=this;this.axios.get("/api/isopen").then(function(n){e.isopen=n.data.isopen,e.initDone=!0}).catch(function(n){e.hasError=!0})},computed:{statusText:function(){return this.isopen?"geöffnet":"geschlossen"}}},h=v,m=(t("f987"),t("2877")),w=Object(m["a"])(h,b,g,!1,null,null,null),k=w.exports,y=t("bc3a"),S=t.n(y),O={name:"home",components:{IsOpenMessage:k},data:function(){return{notificationsSupported:!1,notificationsEnabled:!1,serviceWorkerRegistration:null,subscription:null,message:null}},methods:{enableNotifications:function(){var e=this;this.notificationsSupported&&!this.notificationsEnabled&&Notification.requestPermission().then(function(n){"granted"===n?e.createSubscription().then(function(n){return console.log("Home.vue: subscription created on the client",n),e.subscription=n,S.a.post("api/user",{username:localStorage.getItem("username")})}).then(function(n){var t=n.data,i=t.user;return console.log("Home.vue: user created on the server",i),localStorage.setItem("username",i.name),S.a.post("api/subscription",{subscription:e.subscription,userId:i.id})}).then(function(){e.showFirstNotification(),e.notificationsEnabled=!0}):console.log("Home.vue: User did not grant permission")})},createSubscription:function(){var e=this;return null===this.serviceWorkerRegistration?navigator.serviceWorker.ready.then(function(n){return e.serviceWorkerRegistration=n,e.subscribe(e.serviceWorkerRegistration)}):this.subscribe(this.serviceWorkerRegistration)},subscribe:function(e){console.log("Home.vue: create new subscription for this browser on this device");var n="BE4ll+PKxJkg5t8mmH6++lh3P6oD0M3wn8mNoJ5Dd0sMeGhIRpfUF37oCJ2rJXPfh91DnzolgL4SKzMOiIpC8A8=",t=this.urlBase64ToUint8Array(n);return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})},showFirstNotification:function(){this.serviceWorkerRegistration.showNotification("Benachrichtungen aktiviert!",{body:"Sie werden jetzt benachrichtigt, wenn der Kiosk im Schwimmbad Ebrach öffnet:)",icon:"/img/icons/android-chrome-192x192.png",badge:"/img/icons/kiosk-badge-96x96.png"})},findSubscription:function(){var e=this;return console.log("Home.vue: get active service worker registration"),navigator.serviceWorker.ready.then(function(n){return console.log("Home.vue: active service worker registration received"),e.serviceWorkerRegistration=n,e.getSubscription(e.serviceWorkerRegistration)})},getSubscription:function(e){return console.log("Home.vue: ask for available subscription"),e.pushManager.getSubscription()},urlBase64ToUint8Array:function(e){for(var n="=".repeat((4-e.length%4)%4),t=(e+n).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(t),r=new Uint8Array(i.length),o=0;o<i.length;++o)r[o]=i.charCodeAt(o);return r}},created:function(){"Notification"in window&&"serviceWorker"in navigator&&(this.notificationsSupported=!0),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){"[REFRESH]"==e.data&&(console.log("Client Received Message: "+e.data),window.location.reload()),e.ports[0].postMessage("[REFRESHED]")})},mounted:function(){var e=this;this.findSubscription().then(function(n){null===n?(console.log("Home.vue: no active subscription found on the client"),e.enableNotifications()):(console.log("Active subscription found",n),e.notificationsEnabled=!0,e.subscription=n)})}},_=O,j=Object(m["a"])(_,d,p,!1,null,null,null),E=j.exports,x=function(e){function n(){return Object(s["a"])(this,n),Object(a["a"])(this,Object(c["a"])(n).apply(this,arguments))}return Object(u["a"])(n,e),n}(f["b"]);x=l["a"]([Object(f["a"])({components:{Home:E}})],x);var R=x,M=R,C=(t("78a8"),t("b0a0"),Object(m["a"])(M,r,o,!1,null,null,null)),H=C.exports,W=t("9483");Object(W["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var N=t("a7fe"),A=t.n(N);i["a"].use(A.a,S.a),i["a"].config.productionTip=!1,new i["a"]({render:function(e){return e(H)}}).$mount("#app")},f987:function(e,n,t){"use strict";var i=t("6b51"),r=t.n(i);r.a}});
//# sourceMappingURL=app.60a6941e.js.map